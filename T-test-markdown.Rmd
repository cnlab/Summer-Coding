---
title: "Descriptive Statistics and T-tests"
author: "Steven"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    df_print: paged
    highlight: tango
    theme: united
    toc: yes
    toc_float:
      collapsed: yes
      smooth_scroll: yes
  word_document:
    toc: yes
  pdf_document:
    toc: yes
---

```{r setup, include=FALSE, message=FALSE}
# set chunk options for the document
# include=FALSE means that this chunk will not show up in the report

knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = FALSE, dpi = 150, fig.path = "figs/") 
# echo = TRUE means that the source code will be displayed
# message = FALSE suppresses messages
# warning = FALSE suppresses warnings
# cache = FALSE recompiles from scratch each time you knit 
# dpi = 150 sets the figure resolution
# fig.path specifies a directory where figures will be output

options(digits = 4) 
set.seed(65) #set seed for random number generation
```

# Getting everything set up {.tabset}

## Set Working Directory and Load Packages

```{r}
setwd("/Users/stevenmesquiti/Desktop/Summer Coding Curriculum/Summer-Coding")
if (!require("pacman")) install.packages("pacman") #run this if you don't have pacman 
library(pacman)
pacman::p_load(tidyverse, ggpubr, rstatix, caret, broom, kableExtra, reactable, Hmisc, datarium, psych, install = T) 
#use pacman to load packages quickly 
```

## Get our plot aesthetics set-up

```{r, include=FALSE}
palette_map = c("#3B9AB2", "#EBCC2A", "#F21A00")
palette_condition = c("#ee9b00", "#bb3e03", "#005f73")

plot_aes = theme_classic() +
  theme(legend.position = "top",
        legend.text = element_text(size = 12),
        text = element_text(size = 16, family = "Futura Medium"),
        axis.text = element_text(color = "black"),
        axis.line = element_line(colour = "black"),
        axis.ticks.y = element_blank())
```

## Build Relevant Functions
```{r}
# t-test summary
 ttest_summary <- function(stat_test) {
  t_values <- sapply(stat_test, function(x) x$statistic)
  df <- sapply(stat_test, function(x) x$parameter)
  p_values <- sapply(stat_test, function(x) x$p.value)
  group_1 <- unique(stat_test[[1]]$data[[1]])[[1]]
  group_2 <- unique(stat_test[[1]]$data[[2]])[[1]]
  result <- data.frame(Group_1 = group_1, Group_2 = group_2, t_value = t_values, df = df, p_value = p_values)
  result$p_value <- format(result$p_value, scientific = T)
  colnames(result) <- c("Group 1", "Group 2", "t-value", "df", "p-value")
  kable(result, "latex", booktabs = T, caption = "Summary of t-test results") %>%
    kable_styling(full_width = F)
}



```

## Load data 

```{r}
# Load the data
data("genderweight", package = "datarium")
genderweight <- as.data.frame(genderweight)

# Show a sample of the data by group
set.seed(123)
```

# Brief Description

Filler Text for now. But we are going to be looking at gender differences between males and females in weight using the `genderweight` dataset from the `Datarium` package in R!

# Summarty Statistics {.tabset}

## Sample Size, Means, and Standard Deviations 
```{r}
genderweight %>%
  group_by(group) %>%
  get_summary_stats(weight, type = "mean_sd") %>% 
  reactable::reactable(striped = TRUE)
```

## Build a simple graph to visualize (want to make prettiert)
```{r}
 # Create a box plot with jittered data points
ggplot(genderweight, aes(x = group, y = weight,color = group)) +
  geom_boxplot() +
  geom_jitter(width = 0.2, size = 2) +
  # Add axis labels
  xlab("Groups") +
  ylab("Weight") +
  plot_aes +
  # Add plot title
  ggtitle("Weight by Groups") + theme(plot.title = element_text(hjust = 0.5))
```

# Main Analyses {.tabset}

Now, we'll conduct our independent t-test to see if there are gender differences in weight, as well as getting the proportion of variance accounted for/Magnitude of the effect (Cohen's D).

## Independent T-test

From inspecting our output, we can see that we have a significant effect of gender on weight. 

```{r}
stat.test <- genderweight %>% 
  t_test(weight ~ group) %>%
  add_significance()
stat.test
```

## Cohen's D

From inspecting our output, we can see we have a large effect of gender 

```{r}
genderweight %>%  cohens_d(weight ~ group, var.equal = TRUE)
```
## Visualize our results using GG-Plot with stats

```{r}
plot <- ggplot(genderweight, aes(x = group, y = weight, color = group)) +
  geom_boxplot() +
  geom_jitter(width = 0.2, size = 2) +
  # Add axis labels
  xlab("Groups") +
  ylab("Weight") +
  plot_aes +
  # Add plot title
  ggtitle("Weight by Groups") + theme(plot.title = element_text(hjust = 0.5))

stat.test <- stat.test %>% add_xy_position(x = "group")
plot +  stat_pvalue_manual(stat.test, tip.length = 0) +
  labs(subtitle = get_test_label(stat.test, detailed = TRUE))

```

Add write-up here.


